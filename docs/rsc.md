ТРЕБОВАНИЯ К НАВИГАЦИОННЫМ КАРТАМ.

ФОРМАТ ЦИФРОВОГО КЛАССИФИКАТОРА RSC И БИБЛИОТЕКИ УСЛОВНЫХ ЗНАКОВ

Москва, 2009 г.

# Аннотация

Цифровой классификатор - это совокупность описания слоев векторной карты, видов объектов и их условных знаков, видов семантических характеристик и принимаемых ими значений, представленных в цифровом виде.

Классификатор карты  предназначен для применения в геоинформационных системах для хранения цифровой информации описания карты, обмена данными между различными системами, создания цифровых и электронных карт  и  решения  прикладных задач.

В данном документе описана структура цифрового классификатора.

Формат ориентирован на хранение  информации в виде таблиц  по каждому типу информации.

Данные могут быть представлены как в двоичном, так и в символьном виде.

Классификатор карты в цифровом виде хранится в файле RSC. Файл RSC располагается в одной директории с векторной картой, в общей директории классификаторов или в директории приложения.

# Содержание

1 Общие сведения	4
2 Структура формата	5
2.1 Структура формата в двоичной форме представления	5
2.1.1 Структура заголовка классификатора	6
2.1.2 Структура таблицы объектов  классификатора	9
2.1.3 Структура таблицы семантик  классификатора	11
2.1.4 Структура таблицы  классификатора значений семантики	13
2.1.5 Структура таблицы  умалчиваемых значений семантики	13
2.1.6 Структура таблицы  возможных  семантик объекта	14
2.1.7 Структура таблицы  слоев	15
2.1.8 Структура таблицы  порогов	15
2.1.8.1 Пример таблицы  порогов	17
2.1.9 Структура таблиц параметров экрана и  печати	19
2.1.10 Структура таблицы  палитр	19
2.1.11 Структура таблицы  шрифтов	20
2.1.12 Структура таблицы  библиотек	20
2.1.12 Структура таблицы  таблиц	21
2.1.12 Структура таблицы  CMYK цветов для печати	21
Приложение А Типы графических примитивов и их параметры	23

# 1 Общие сведения
Цифровой классификатор предназначен для хранения данных, которые определяют вид и назначение электронной карты, а также:
Включает в себя описание слоев карты и порядка вывода их на носитель;
Позволяет задавать семантические характеристики карты, их тип и границы значений;
Обеспечивает большое количество видов визуального представления объектов;
Позволяет описать для каждого объекта необходимые семантические характеристики;
Предоставляет возможность отображать информацию с использованием нескольких различных палитр;
Обеспечивает возможность подключения библиотек разработанных пользователем для визуального представления объектов.

# 2 Структура формата

## 2.1 Структура формата в двоичной форме представления

Основная цифровая информация размещена в одном файле:

XXXXXXXX.RSC ,

где XXXXXXXX - идентификатор цифровой информации для заданного масштаба
и типа карты, может присваиваться по любым правилам.

Данные в формате RSC имеют следующую структуру:


    Файл цифрового описания карты
    - Заголовок данных XXXXXXXX.RSC
    -- Записи таблиц
    --- Дескриптор таблицы объектов
    --- Записи объектов
    --- Дескриптор таблицы слоев
    --- Записи слоев
    --- и т.д.

Для отображения объектов, внешний вид которых  создает пользователь, необходим также файл XXXXX.IML.

### 2.1.1 Структура заголовка классификатора

Заголовок классификатора  содержит сведения о количественном и качественном составе классификатора.
Данные  заголовка классификатора хранятся в символьном и двоичном виде в зависимости от поля записи. Символьные поля заполняются в формате ANSI.
Двоичные поля содержат целые числа в 4 байтах. Если данные для каких-то полей неизвестны, то поле должно содержать нулевое значение. Поля длиной 8 байт в формате с плавающей точкой стандарта IEEE, если данных нет - поля содержат нулевое значение.
Структура заголовка классификатора приведена в таблице 2.1.

    Таблица 2.1

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------
Идентификатор файла  | +0 | 4 | 0x00435352 (RSC)
Длина файла +4  4 В байтах
Версия структуры RSC +8 4 0x0700

Кодировка +12 4 Для всего файла
Номер состояния файла +16 4 Учет  корректировок, требующих перегрузки данных
Номер модификации состояния +20 4 Учет корректировок
Используемый язык +24 4 1-английский, 2-русский
Максимальный идентификатор таблицы объектов +28 4 Идентификатор для нового объекта
Дата создания файла +32 8 ГГГГММДД
Тип карты   +40 32 Примечание 1.
Условное название классификатора +72 32 ANSI
Код классификатора +104 8 ANSI
Масштаб карты +112 4 Базовый масштаб карты, на который составлен классификатор. Значение поля  не  акладывает ограничений на применение с картами другого базового масштаба.
Масштабный ряд +116 4 Примечание 2

Смещение на таблицу объектов +120 4 От начала файла
Длина таблицы объектов +124 4 В байтах
Число записей +128 4 Записи переменной длины

Смещение на таблицу семантики +132 4 От начала файла
Длина таблицы семантики +136 4 В байтах
Число записей +140 4 Записи постоянной длины

Смещение на таблицу классификатор семантики +144 4 От начала файла
Длина таблицы классификатор семантики +148 4 В байтах
Число записей +152 4 Записи постоянной длины

Смещение на таблицу умолчаний +156 4 От начала файла
Длина таблицы умолчаний +160 4 В байтах
Число записей +164 4 Записи постоянной длины

Смещение на таблицу возможных семантик +168 4 От начала файла
Длина таблицы возможных семантик +152 4 В байтах
Число записей +156 4 Записи переменной длины

Смещение на таблицу сегментов (слоев) +160 4 От начала файла
Длина таблицы сегментов (слоев) +164 4 В байтах
Число записей +168 4 Записи переменной длины

Смещение на таблицу Порогов +172 4 От начала файла
Длина таблицы порогов +176 4 В байтах
Число записей +180 4 Записи переменной длины

Смещение на таблицу параметров +184 4 От начала файла
Длина таблицы параметров +188 4 В байтах
Число записей +192 4 Записи переменной длины

Смещение на таблицу параметров печати +196 4 От начала файла
Длина таблицы параметров печати +200 4 В байтах
Число записей +204 4 Записи переменной длины

Смещение на таблицу  палитр +208 4 От начала файла
Длина таблицы палитр +212 4 В байтах
Число записей +216 4 Записи постоянной длины

Смещение на таблицу  шрифтов +220 4 От начала файла
Длина таблицы шрифтов +224 4 В байтах
Число записей +228 4 Записи постоянной длины

Смещение на таблицу библиотек +232 4 От начала файла
Длина таблицы библиотек +236 4 В байтах
Число записей +240 4 Записи постоянной длины

Смещение на таблицу изображений семантики +244 4 От начала файла
Длина таблицы  изображений семантики +248 4 В байтах
Число записей +252 4 Записи постоянной длины

Смещение на таблицу  таблиц +256 4 От начала файла
Длина таблицы таблиц +260 4 В байтах
Число записей +264 4 Записи постоянной длины

Флаг использования ключей как кодов +268 1
Флаг модификации палитры +269 1 Учет корректировок

Резерв   +270 2 0
Резерв +272 4 Не использовать
Резерв +276 4 Не использовать
Резерв +280 20 0

Кодировка шрифтов +300 4 125- строка (KOI8), ограниченная нулем; 126 - строка (ANSI, WINDOWS), ограниченная нулем.
Количество цветов в палитрах +304 4 Не более 256, одинаково для всех палитр
ИТОГО: 308 байт

(!) ошибка. общая длина - 328 байт

Примечания:
1. Тип карты (символьное поле 32 байта). Значение поля  не влияет на применение с картами других типов. Возможные значения:
- не установлено;
- топографическая;
- обзорно-географическая;
- космонавигационная ("Глобус");
- топографический план города;
- крупномасштабный план местности;
- аэронавигационная;
- морская навигационная;
- авиационная.
2. Границы видимости объектов на карте задаются двумя списками масштабов - для мелкомасштабных карт и для крупномасштабных. Для карт масштабов от 1:1 до 1:10000 целесообразно выбирать значение 1 - крупномасштабная, для остальных карт – 0- мелкомасштабная.
Для мелкомасштабных карт границы видимости объектов могут принимать значения: 1:1000, 1:2000, 1:5000, 1:10000, 1:25000, 1:50000, 1:100000, 1:200000, 1:500000, 1:1000000, 1:2500000, 1:5000000, 1:10000000, 1:20000000, 1:40000000.
Для крупномасштабных карт границы видимости объектов могут принимать значения: 1:1, 1:10, 1:25, 1:50, 1:100, 1:200, 1:500, 1:1000, 1:2000, 1:5000, 1:10000, 1:25000, 1:50000, 1:100000, 1:200000, 1:500000.

### 2.1.2 Структура таблицы объектов  классификатора

Таблица объектов классификатора находится по смещению на таблицу объектов, имеет общую длину, указанную в заголовке классификатора. Перед таблицей объектов классификатора находится идентификатор таблицы “OBJ” (шестнадцатеричное число 0X004A424F)  (не входит в длину таблицы).  Записи таблицы объектов переменной длины, не менее 112 байт. Одна запись на один объект классификатора.

    Таблица 2.2

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Длина записи объекта
+0
4
В байтах

Классификационный код
+4
4

Внутренний код объекта
+8
4
Порядковый номер объекта (может меняться) (с 1)

Идентификационный код
+12
4
Неизменяемый уникальный номер объекта

Короткое имя объекта
+16
32
Уникальное символьное имя (ANSI)

Название
+48
32
ANSI

Характер локализации
+80
1
Примечание 1.

Номер слоя (сегмента)
+81
1
Число от 0 до 255

Признак масштабируемости
+82
1
0 - условный знак объекта не масштабируемый;
1 - знак масштабируется;

Нижняя граница видимости
+83
1
Число от 0 до 15 (N1)

Верхняя граница видимости
+84
1
Число от 0 до 15 (15 – N2)

Расширение локализации
+85
1
1 - при создании линейных объектов учитывать две точки метрики
0 – все точки метрики

Направление цифрования
+86
1
Примечание 2.

Отображение с учетом семантики
+87
1
1- для объектов с внешним видом пользователя, учитывающих семантику

Номер расширения
+88
2
Для объектов из серии – номер объекта в серии, для остальных 0.

Количество связанных подписей
+90
1
Число от 0 до 16

Признак сжатия объекта
+91
1
Возможность сжатия объекта при уменьшении масштаба
1 – не сжимать

Максимальное увеличение
+92
1
Максимальное увеличение объекта (от 1 до 25.0 раз)
Значения от 0 до 250

Максимальное уменьшение
+93
1
Максимальное уменьшение объекта (от 1 до 25.0 раз)
Значения от 0 до 250

Флаг включения границ
+94
1
Флаг включения границ видимости

Резерв
+95
1

Связанная подпись объекта определяет шрифт, предназначенный для нанесения подписей объекта, текст которых содержится в качестве семантической характеристики этого объекта.
Описание связанных подписей имеет следующий вид:

Таблица 2.3.

Назначение поля
Смещение
Длина
Комментарий

Идентификационный код связанной подписи
+0
4
Неизменяемый уникальный номер подписи

Классификационный код семантики
+4
4
Код семантики объекта, содержащей текст подписи

Постоянный префикс для подписи
+8
7
В байтах

Количество десятичных знаков после запятой
+15
1
Используется при печати подписи

ИТОГО: 16 байт

Примечания:
1. Характер локализации  (1 байт):
0х00 - линейный,
0х01 – площадной,
0х02 – точечный,
0х03 – подпись,
0х04 - векторный (точечный ориентированный объект, содержит две точки в   метрике),
0x05 - шаблон подписи (первая точка метрики является точкой привязки шаблона, метрика подобъектов задает расположение подписей и вспомогательных  линий).
2. Направление цифрования объекта:
0x00-произвольное,
0x01-определенное,
0х02-объект справа,
0x04-объект слева.

Для площадных объектов возможны направления цифрования объект слева (обход объекта против часовой стрелки: используется для водоемов и углублений рельефа) и объект  справа (обход объекта по часовой стрелке).

Для линейных объектов можно определенное (для тех объектов, для которых имеет смысл различать начало и конец метрики, например реки, цифруются от истока к устью) и произвольное для всех  остальных случаев.

Точечные объекты имеют только произвольное направление цифрования.

Все остальные произвольное или определенное.

Связанные подписи объектов предназначены для нанесения на карту  подписей по   семантическим характеристикам объекта, определенным видом шрифта. Шрифт выбирается из существующих  подписей классификатора.

### 2.1.3 Структура таблицы семантик классификатора

Таблица семантик классификатора находится по смещению на таблицу семантик, имеет общую длину, указанную в заголовке классификатора. Перед таблицей семантик классификатора находится идентификатор таблицы “.SEM” (шестнадцатеричное число 0X004D4553)  (не входит в длину таблицы).  Записи таблицы семантики постоянной длины, 84 байт. Одна запись на одну семантику классификатора.


Таблица 2.4

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------
Код семантики           | +0 | 4 | Неизменяемый уникальный
Тип значения семантики  | +4 | 2 | Примечание 1
Повторяемость семантики | +6 | 1 | 1 - у объекта может быть несколько значений семантики с таким кодом
Признак служебной семантики | +7 | 1 | 1 - семантику можно использовать для всех объектов классификатора
Название | +8 | 32 | ANSI
Короткое имя семантики | +40 | 16 | Уникальное символьное имя (ANSI). Используется для подписей полей в базах данных
Единица измерения | +56 | 8 | ANSI
Размер поля семантики | +64 | 2 | Число от 0 до 255
Точность семантики | +66 | 1 | Количество цифр после запятой (при выводе)
Флаг | +67 | 1 | 2 семантика составная
Смещение на описание классификатора семантики | +68 | 4 | От начала файла.  Если нет записей – 0
Количество записей в классификаторе данной семантики | +72 | 4 | Если нет записей – 0
Смещение на умалчиваемые значения семантики | +76 | 4 | От начала файла. Если нет записей – 0.
Количество записей для умалчиваемых значений | +80 | 4 | Если нет записей – 0
ИТОГО: | | 84 байта |

Примечания:
1. Тип значения семантики  (1 байт):
0х00  -  символьная строка,
0х01  -  числовое значение или значение в виде числового кода
из классификатора значений
0х09  -  имя файла зарегистрированного типа
0х0А -  имя файла BMP
0x0B -  имя файла, обрабатываемого OLE-сервером
0x0C - ссылка на произвольный объект карты (уникальный номер объекта)
0x0D - имя файла-паспорта района
0x0E -  имя текстового файла
0x0F -  имя файла PCX

2. В классификаторе существуют        зарезервированные коды       семантических  характеристик:
32800 -  классификационный код объекта,
32801 - признак объекта, имеющего ссылку на подчиненный объект,
32802 - признак объекта, на который имеется ссылка от главного объекта,
32803 - признак объекта, входящего в группу равноправных объектов,
32804 - ссылка на подпись от объекта,
32805 - ссылка на объект от подписи,
32810 - короткое имя слоя объекта,
32811 - короткое имя объекта (ключ),
91000000l - внешний код рамки листа.

### 2.1.4 Структура таблицы классификатора значений семантики

Для каждой семантической характеристики может быть создан классификатор значений. При этом для числовых характеристик одному коду обычно соответствует диапазон значений (например, ширина реки: до 5м - 1, от 5 до 10 - 2 и т.д.), для символьных характеристик одному коду соответствует одно значение (материал строения: дерево - 1, кирпич - 2 и т.д.).

Если для характеристики создается классификатор значений, то в таблице семантики  она объявляется числовой (физически ее значение - числовой код, но при работе с этой характеристикой в системе электронных карт будет отображаться логическое значение, соответствующее текущему коду).

Записи классификатора значений относящиеся к конкретной семантике лежат в таблице подряд.

Таблица классификатора значений семантики находится по смещению на таблицу классификатора значений семантики. Имеет общую длину, указанную в заголовке классификатора. Перед таблицей классификатора значений семантики находится идентификатор таблицы “.CLS” (шестнадцатеричное число 0X00534С43)  (не входит в длину таблицы).  Записи таблицы классификатора значений семантики постоянной длины, 36 байт. Количество записей на одну семантику классификатора указывается в таблице семантики. Смещение на записи классификатора значений для конкретной семантики, указываются в таблице семантики.

    Таблица 2.5

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------
Числовое значение семантики        |       +0 |     4 |
Символьное значение семантики      |       +4 |    32 | ANSI
ИТОГО:                             |          | 84 байта |

### 2.1.5 Структура таблицы умалчиваемых значений семантики

Каждой семантической характеристике с числовым значением (в том числе и классификатором значений) можно назначить максимальное, минимальное и умалчиваемое значение. Для каждой возможной семантики отдельного объекта тоже можно назначить максимальное, минимальное и умалчиваемое значение семантики для данного объекта классификатора.   Все эти значения лежат в одной таблице.    Записи умалчиваемых значений  относящиеся к конкретной семантике лежат в таблице подряд.

Таблица умалчиваемых значений семантики находится по смещению на таблицу умолчаний семантики. Имеет общую длину, указанную в заголовке классификатора.

Перед таблицей умалчиваемых значений семантики находится идентификатор таблицы “.DEF” (шестнадцатеричное число 0X00464544)  (не входит в длину таблицы).

Записи таблицы умалчиваемых значений семантики постоянной длины, 32 байта. Количество записей на одну семантику классификатора указывается в таблице семантики. Смещение на записи умалчиваемых значений для конкретной семантики, указываются в таблице семантики.

    Таблица 2.6

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Порядковый номер объекта
+0
4
Если номер равен 0 – это умалчиваемое значение для семантики
Код семантики
+4
4
Из таблицы  2.4
Минимальное значение семантики
+4
8

Значение семантики
по умолчанию
+8
8

Максимальное значение
Семантики
+8
8

ИТОГО:
32 байта

### 2.1.6 Структура таблицы возможных семантик объекта

Для каждого объекта классификатора пользователь может назначить обязательную или возможную семантику. Если семантика возможная, заполнение ее при нанесении объекта на карту не обязательно. Если пользователь не заполнит значение обязательной семантики объекта, семантика будет записана с умалчиваемым значением.

Все объекты серии имеют одну запись в таблице возможных семантик.

Перед таблицей возможных семантик объекта находится идентификатор таблицы “.POS” (шестнадцатеричное число 0X00534F50)  (не входит в длину таблицы).  Записи таблицы умалчиваемых значений семантики переменной длины, более 20 байт.

    Таблица 2.7

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------
Длина записи | +0 | 4 | В байтах, с учетом длины кодов семантик
Классификационный код объекта | +4 | 4 |
Локализация | +4 | 1 |
Резерв      | +5 | 3 | 0
Количество обязательных семантик |  +8 | 2 | Число от 0 до 255 (N4)
Количество возможных семантик    | +10 | 2 | Число от 0 до 255  (N5)
Коды семантик                    | +12 | 4 |
ИТОГО:                           |     | 16 байт + (N4+N5) * 4 |

### 2.1.7 Структура таблицы слоев

Таблица слоев классификатора находится по смещению на таблицу слоев. Имеет общую длину, указанную в заголовке классификатора.

Перед таблицей слоев (сегментов) находится идентификатор таблицы “.SEG” (шестнадцатеричное число 0X00474553)  (не входит в длину таблицы).  Записи таблицы слоев (сегментов) переменной длины, более 60 байт.


Таблица 2.8

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Длина записи
+0
4
В байтах, с учетом длины кодов семантик
Название слоя
+4
32
ANSI
Короткое название слоя
+36
16
ANSI. Для связи с названием полей в базах данных
Номер слоя (сегмента)
+52
1
Соответствует номеру, из таблицы объектов
Порядок отображения объектов слоя
+53
1
Число от 0 до 255   Меньший номер будет отображаться  раньше
Количество семантик слоя
+54
2
Число от 0 до 255  (N6)
Коды семантик
+56
4
Семантики слоя используются при переходе
к другим ГИС
ИТОГО:
Если N6  <= 1   60 байт  иначе 60 байт  +  (N6 – 1)  * 4

### 2.1.8 Структура таблицы  порогов

Таблица порогов представляет собой двоичное описание серии объектов.
Серия объектов это несколько объектов с одинаковым кодом, локализацией и семантикой. Серия предназначена для отображения объектов классификатора в тех случаях, когда объект должен менять внешний вид в зависимости от значений семантики (одной или двух). Описание каждого объекта серии лежит отдельно, а таблица порогов позволяет узнать, какой именно объект серии соответствует данному сочетанию значений семантических характеристик.
Перед таблицей порогов находится идентификатор таблицы “.LIM” (шестнадцатеричное число 0X004D494C)  (не входит в длину таблицы).  Записи таблицы порогов переменной длины.

    Таблица 2.9

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Длина записи
+0
4
В байтах, с учетом длины ограничителей и матрицы расширений (N7)
Классификационный код
+4
4
Общий код для  всех объектов серии
Локализация
+8
1
Общая для  всех объектов серии
Резерв
+9
7
В байтах
Код первой семантики

+16
4
Код семантики, влияющей на вид объекта
Количество ограничителей
по первой семантике
+20
2
Число от 0 до 255  (N8)
Номер умалчиваемого ограничителя по первой семантике
+22
2
Примечание 1.
Код второй семантики
+24
4
Код семантики, влияющей на вид объекта. При  отсутствии второй семантики  0
Количество ограничителей
по второй семантике
+28
2
Число от 0 до 255  (N9)
Номер умалчиваемого ограничителя по второй семантике
+30
2
Примечание 1.
Ограничители по первой семантике
+32
8*N8
Ограничители упорядочены по возрастанию
Ограничители по второй семантике
+32+8*N8
8*N9
Ограничители упорядочены по возрастанию
Матрица расширений
+32
+8 * (N8+N9)
N8*N9
если N9=0
N8
Значениями матрицы являются номера расширений объектов
(Числа от 0 до 255)
ИТОГО:
N7

Примечания:
1. Ограничители семантики упорядочены по возрастанию  и показывают граничные значения семантики, при которых вид объекта будет меняться. Нижняя граница не включается в интервал значений, а верхняя включается. Если семантика объекта, влияет на вид объекта, а значение ее не установлено, будет выбрано значение умалчиваемого ограничителя.
2. Матрицу расширений можно рассматривать как следующую таблицу:

    Таблица 2.10.

    Семантики
    2\1
    Ограничители 1 семантики
    < 1 огр                     <2 огр                       …                       <n огр

    Ограничители
    2
    семантики
    1 расширение
    2 расширение

    N расширение

    N+1 расширение
    Матрица расширений

#### 2.1.8.1 Пример таблицы  порогов

Рассмотрим серию объектов  с кодом 441000000 – Строения, площадные.
В серии 7 объектов. Вид этих объектов зависит от двух семантик. 13 – Характер огнестойкости и 3 – Состояние. Значения обеих семантик – числовые, в виде классификатора значений.

Объекты серии:
1. Строения нежилые огнестойкие    (расширение 1)
2. Строения нежилые смешанные      (расширение 2)
3. Строения нежилые неогнестойкие (расширение 3)
4. Строения жилые огнестойкие        (расширение 4)
5. Строения жилые неогнестойкие     (расширение 5)
6. Строения жилые смешанные          (расширение 6)
7. Строения строящиеся                     (расширение 7)

Значения 1 семантики - 13 – Характер огнестойкости:
1. Огнестойкий     - 1
2. Не огнестойкий - 2
3. Смешанный       - 4
Значения 2 семантики - 3 – Состояние:
1. Строящийся - 2
2. Жилой          - 5
3. Не жилой.    - 6

При отсутствии значений семантики  считаем Характер огнестойкости – Не огнестойкий (2), Состояние – Не жилой (3).
В матрице расширений значения могут повторяться.
При записи в файл длина записи выравнивается на 8.
В числовом виде это описание показано в Таблице 2.11.

    Таблица 2.11

Назначение поля                    | Смещение | Длина | Значение (в десятичном виде)
-----------------------------------|----------|-------|------------

Длина записи
+0
4
96 (89+7для выравнивания)
Классификационный код
+4
4
44100000
Локализация
+8
1
1
Резерв
+9
7
\0
Код первой семантики

+16
4
13
Количество ограничителей
по первой семантике
+20
2
3
Номер умалчиваемого ограничителя по первой семантике
+22
2
2
Код второй семантики
+24
4
3
Количество ограничителей
по второй семантике
+28
2
3
Номер умалчиваемого ограничителя по второй семантике
+30
2
3
Ограничители по первой семантике
+32
3*8
1,
2,
4
Ограничители по второй семантике
+56
3*8
2,
5,
6.
Матрица расширений
+80

9

7,7,7,
4,6,5,
1,3,2.


### 2.1.9 Структура таблиц параметров экрана и печати

Таблица параметров  классификатора находится по смещению на таблицу параметров. Имеет общую длину, указанную в заголовке классификатора.
Перед таблицей параметров находится идентификатор таблицы “.PAR” (шестнадцатеричное число 0X00524150)  (не входит в длину таблицы).  Записи таблицы параметров переменной длины, более 8 байт.
Таблица параметров печати  классификатора находится по смещению на таблицу параметров печати. Имеет общую длину, указанную в заголовке классификатора.
Перед таблицей параметров находится идентификатор таблицы “.PRN “(шестнадцатеричное число 0X004E5250)  (не входит в длину таблицы).  Записи таблицы параметров переменной длины, более 8 байт.  Таблицы имеют одинаковую структуру.
Для каждого объекта классификатора обязательно есть экранные параметры, а параметров печати может не быть. При записи в файл длина записи выравнивается на 4.

Таблица 2.12

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Длина записи
+0
4
В байтах, с учетом длины кодов семантик
Внутренний код объекта
+4
2
Порядковый номер объекта
Номер функции отображения
+6
2
Код типа примитива.
Параметры отображения
+8
?
Параметры примитива соответствующие типу
Приложение А.
ИТОГО:
8 байт   +  длина параметров примитива.

### 2.1.10 Структура таблицы  палитр

Таблица палитр классификатора находится по смещению на таблицу палитр. Имеет общую длину, указанную в заголовке классификатора.
Перед таблицей палитр находится идентификатор таблицы “.PAL” (шестнадцатеричное число 0X004C4150)  (не входит в длину таблицы).  Записи таблицы палитр постоянной длины 1056 байт.

    Таблица 2.13

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Палитра в формате RGB
+0
1024
4 байта на цвет
Название палитры
+1024
32
Уникальное символьное имя (ANSI)
ИТОГО:
1056 байт

### 2.1.11 Структура таблицы  шрифтов

Таблица шрифтов классификатора находится по смещению на таблицу шрифтов. Имеет общую длину, указанную в заголовке классификатора.
Перед таблицей шрифтов находится идентификатор таблицы “.TXT” (шестнадцатеричное число 0X00545854)  (не входит в длину таблицы).  Записи таблицы шрифтов постоянной длины 72 байта.

    Таблица 2.14

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Название шрифта
+0
32
Имя файла, где находится шрифт
Условное название
+32
32
Уникальное символьное имя (ANSI)
Код
+64
4
Идентификационный номер шрифта в классификаторе
Номер символа для уточнения высоты шрифта
+68
1
Номер символа шрифта, высота которого точно равняется заданной высоте (по умолчанию “0”)
Кодовая страница
+69
1
Кодовая страница Windows
Резерв
+70
2
0
ИТОГО:
72 байта

### 2.1.12 Структура таблицы  библиотек

Таблица библиотек классификатора находится по смещению на таблицу библиотек. Имеет общую длину, указанную в заголовке классификатора.
Перед таблицей библиотек находится идентификатор таблицы “.IML” (шестнадцатеричное число 0X004C4D49)  (не входит в длину таблицы).  Записи таблицы библиотек постоянной длины 120 байт.

    Таблица 2.15

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Имя библиотеки (.DLL,.IML)
+0
80
Имя файла библиотеки
Условное название
+80
32
Уникальное символьное имя (ANSI)
Код библиотеки
+112
4
Идентификационный номер библиотеки в классификаторе
Индекс открытой библиотеки
+116
4
0
ИТОГО:
120 байта

### 2.1.12 Структура таблицы  таблиц

Таблица таблиц  классификатора находится по смещению на таблицу таблиц. Имеет общую длину, указанную в заголовке классификатора.
Перед таблицей библиотек находится идентификатор таблицы “.TAB” (шестнадцатеричное число 0X00424154)  (не входит в длину таблицы).  Запись таблицы таблиц постоянной длины 72 байта.

    Таблица 2.16

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Смещение на таблицу цветов печати
+0
4
От начала файла
Длина таблицы
+4
4
В байтах
Число записей
+8
4
Запись постоянной длины
Резерв
+12
60
Не использовать
ИТОГО:
72 байта

### 2.1.12 Структура таблицы  CMYK цветов для печати

Таблица цветов для печати классификатора находится по смещению на таблицу цветов печати, указанную в таблице таблиц. Имеет общую длину, указанную в таблице таблиц классификатора.
Перед таблицей цветов для печати находится идентификатор таблицы “.СMY” (шестнадцатеричное число 0X00594D43)  (не входит в длину таблицы).  Записи таблицы цветов для печати постоянной длины 1024 байта.

    Таблица 2.17

Назначение поля                    | Смещение | Длина | Комментарий
-----------------------------------|----------|-------|------------

Палитра в формате CMYK
+0
1024
4 байта на цвет
ИТОГО:
1024 байт


# Приложение А Типы графических примитивов и их параметры

Цвет графических примитивов может задаваться двумя способами: цветом в формате RGB либо номером цвета в палитре классификатора. Если цвет выбирается из палитры, его значение записывается в  следующем  виде: 0x0F0000XX, где XX – номер цвета в палитре (с 0). В формате RGB значение записывается в виде 0x00RRGGBB.

1. Простая линия, код типа примитива  128.

Назначение поля
Смещение
Длина
Комментарий

Цвет линии
+ 0
4
RGB или индекс
Толщина линии
+ 4
4
В микронах
Итого:   8 байт


2. Пунктирная линия, код типа примитива  129.

Назначение поля
Смещение
Длина
Комментарий

Цвет линии
+ 0
4
RGB или индекс
Толщина линии
+ 4
4
В микронах
Длина штриха
+ 8
4
В микронах
Длина пробела
+ 12
4
В микронах
Итого:   16 байт


3. Смещенный пунктир, код типа примитива  148.

Назначение поля
Смещение
Длина
Комментарий

Цвет линии
+ 0
4
RGB или индекс
Толщина линии
+ 4
4
В микронах
Длина штриха
+ 8
4
В микронах
Длина пробела
+ 12
4
В микронах
Направление и величина сдвига линии
+16
4
= 0 пунктир лежит справа вплотную к оси
> 0 сдвигаемся вправо от оси, иначе влево.
В микронах
Итого:   20 байт


4. Площадь, код типа примитива  135.

Назначение поля
Смещение
Длина
Комментарий

Цвет площади
+ 0
4
RGB или индекс
Итого:   4 байта



5. Штрихованная площадь, код типа примитива  153.

Назначение поля
Смещение
Длина
Комментарий

Длина параметров
+ 0
4
В байтах
Угол наклона штриховки
+ 4
4
В градусах (0-180),
против часовой стрелки от горизонтали
Шаг штриховки
+ 8
4
В микронах, расстояние между осями штриховых линий
Номер примитива
линии штриховки
+ 12
4
128 или 129
Параметры штриховой линии по типу примитива
+16
?

Итого:   16 байт + длина параметров штриховой линии


6. Точечный объект, код типа примитива  143.

Назначение поля
Смещение
Длина
Комментарий

Длина параметров
+ 0
4
В байтах
Число цветов в знаке
+ 4
4
Количество цветовых масок
Размер стороны знака
+ 8
4
В микронах Примечание 1
Точка привязки (вертикаль)
+ 12
4
В микронах Примечание 2
Точка привязки (горизонталь)
+ 16
4
В микронах Примечание 2
Описание цветовых масок
+ 20
?
По числу цветов
Цвет маски
+ 0
4

Маска знака
+ 4
128
Бит на точку, 32*32
Итого: 20 байт  +  число цветов * 132

Примечания:
1. Задается размер стороны маски знака (32 точки – x микрометров).
2. Точка привязки знака отсчитывается от левого верхнего угла маски (величина  привязки меньше размера стороны маски).


7. Площадь, заполненная знаками, код типа примитива  144.

Назначение поля
Смещение
Длина
Комментарий

Тип сетки заполнения
+ 0
2
Примечание 1
Флаг заполнения
+2
1
0 - по всей площади                                   1 -только полностью входящими знаками
Толщина контура знака
+3
1
0 – тонкий
1 - нормальный
Параметры знака
+4
?
Примечание 2.
Итого:   4 байта + длина параметров заполняющего знака

Примечания:
1. Возможные значения для типа заполнения сетки:
Регулярная                    - 0x0000FFFFL;
Шахматная                    - 0x0000A5A5L;
Шахматная смещенная  -   0x00005A5AL.
2. Шаг сетки по горизонтали и вертикали в микронах задается в параметрах заполняющего знака. В поле “Точка привязки (вертикаль)”  устанавливается шаг сетки по вертикали, в поле “Точка привязки (горизонталь)”  устанавливается шаг сетки по горизонтали. Шаг сетки не может быть меньше размера стороны знака.


8. Окружность, код типа примитива  140.

Назначение поля
Смещение
Длина
Комментарий

Цвет окружности
+ 0
4
RGB или индекс
Толщина линии
+ 4
4
В микронах
Радиус окружности
+ 8
4
В микронах
Итого:  12 байт


9. Освещение участка, код типа примитива  154.

Назначение поля
Смещение
Длина
Комментарий

Процент  изменения яркости
+ 0
4
Значения от –100 до 100
Процент изменения контраста
+ 4
4
Значения от –100 до 100
Итого:  8 байт
Применяется для выделения (высветления или затемнения) участка карты.
10. Векторный знак, код типа примитива  149.
Векторные объекты используются для отображения внемасштабных ориентируемых условных знаков, и имеют одну или две точки метрики. Для обеспечения ориентируемости и масштабируемости векторный знак состоит из частей: линий, полигонов, окружностей и т.д. Для привязки  знака к первой точке метрики используется отсчет. Начало отсчета указывает точку привязки знака.

Назначение поля
Смещение
Длина
Комментарий

Длина параметров
+ 0
4
В байтах (N1)
Точка привязки (вертикаль)
+ 4
4
В микронах Примечание 1
Точка привязки (горизонталь)
+ 8
4
В микронах Примечание 1
Длина базы знака
+ 12
4
В микронах Примечание 2
Начало отметки по вертикали
+ 16
4
Примечание 3
Конец отметки по вертикали
+ 20
4
Примечание 3
Требуемый размер по вертикали
+24
4
Примечание 3
Начало отметки по горизонтали
+28
4
Примечание 3
Конец отметки по горизонтали
+32
4
Примечание 3
Требуемый размер по горизонтали
+36
4
Примечание 3
Флаг расположения
+40
1
1 –база знака расположена горизонтально,
0 - по метрике
Флаг зеркального отображения
+41
1
Примечание 4
Флаг запрета сжатия знака
+42
1
1 – знак не сжимается при уменьшении изображения
Признак растягивания по метрике
+43
1
1 – база знака совмещается с  первыми двумя точками метрики
Признак центрирования по метрике
+44
1
1 – объект центрируется по метрике
Резерв
+44
4
0
Максимальный габарит знака
+48
4
Примечание 5
Число фрагментов, описывающих знак
+52
4

Описание фрагментов
+ 56
?

Итого: N1

Описание фрагмента

Назначение поля
Смещение
Длина
Комментарий

Тип цепочки
+ 0
1
Примечание 6
Тип параметров
+ 1
1
Примечание 7
Длина параметров
+ 2
2
В байтах (не менее 4)
Параметры цепочки по ее типу
+ 4
N

Параметры цепочки по ее типу
Количество точек в цепочке
+ 4+N
4
Не более 512
X-координата точки
+ 8+N
4
Примечание 8
Y – координата точки
+ 12+N
4

Итого: 8 байт  +  N + количество  точек цепочки* 8

Примечания:
1. Точка привязки знака отсчитывается от левого верхнего угла. При отображении объекта совмещается с первой точкой метрики.
2. База     знака       откладывается по горизонтали от точки привязки.    Служит для ориентации объекта. Если объект растягивается по метрике, база знака совмещается с первыми двумя точками метрики. Если флаг расположения равен единице, база знака располагается горизонтально.
3. Отметки по горизонтали и вертикали указывают, какая  часть знака будет иметь требуемый размер. При различных сочетаниях этих параметров знак, может  быть, при  отображении вытянут по горизонтали или вертикали или сохранять  пропорциональность. Если один из требуемых размеров (по вертикали  или    горизонтали) равен 0, знак при отображении сохраняет пропорции.
4. Для объектов, у которых важно понятие верха и низа (флаги и т.п.),предусмотрен флаг зеркального отображения. Такие объекты при изменении порядка точек метрики не переворачиваются  “вниз головой”, а симметрично отображаются относительно  вертикальной оси.
5. Максимальный       габарит       знака – величина в микронах,     показывающая      наибольшее удаление точек объекта от точки отсчета.
6. Возможные значения для типа цепочки:
Площадь                     - 0;
Линия                         - 1;
Круг (площадной)      - 6;
Окружность               - 7;
Эллипс                       - 64;
Эллипс (площадной) – 65;
Дуга                           - 66;
Сектор (площадной)  - 67.
Текст постоянный -  68
Текст из семантики – 69
Дуга окружности обратная - 70
7. Возможные значения для типа параметров
Линия – 128;
Площадь – 135;
Пунктир – 129;
Тест для векторных - 160
8. Координаты берутся от точки привязки вправо и вниз в соответствии с типом цепочки. У цепочек с типом более 1 существуют выделенные точки. Координаты выделенных точек берутся от левого верхнего угла.   Две выделенные точки для окружности, круга, эллипса – центр и радиусы по вертикали и горизонтали (для окружности и круга совпадают). Четыре выделенных точки для сектора и дуги: центр,  радиусы по вертикали и горизонтали (одинаковые), начало и конец дуги.
11. Площадь, заполненная векторными знаками, код типа примитива  155.

Назначение поля
Смещение
Длина
Комментарий

Длина параметров
+0
4
в байтах (N1)
Тип сетки заполнения
+4
2
Примечание 1
Флаг заполнения
+6
1
0 - по всей площади                                   1 -только полностью входящими знаками
Резерв
+7
1
0
Расстояние между знаками по горизонтали
+8
4
Примечание 2.
Расстояние между знаками по вертикали
+12
4
Примечание 2.
Угол поворота знака
+16
4
В градусах (0-180), по часовой стрелке от вертикали
Параметры знака
+20
?
Параметры векторного знака
Итого:   N1

Примечания:
1. Возможные значения для типа заполнения сетки:
Регулярная                     - 0x0000FFFFL;
Шахматная                     - 0x0000A5A5L;
Шахматная смещенная  -   0x00005A5AL.
2. Шаг сетки по горизонтали и вертикали в микронах  Шаг сетки не может быть меньше размера стороны знака.














12. Декорированная линия, код типа примитива  157.
Служит для создания сложных изображений линейных объектов, таких как линии электропередач, водопроводы и т.д.

Назначение поля
Смещение
Длина
Комментарий

Длина параметров
+0
4
В байтах (N1)
Длина, занимаемая знаком  в начале линии
+4
4
В микронах
Длина, занимаемая знаком в конце линии
+8
4
В микронах
Длина, занимаемая знаком в начале отрезка
+12
4
В микронах
Длина, занимаемая знаком в конце отрезка
+16
4
В микронах
Длина, занимаемая первым заполняющим знаком
+20
4
В микронах
Длина, занимаемая вторым заполняющим знаком
+24
4
В микронах
Флаг равномерного размещения заполняющих знаков
+28
1
В микронах
Резерв
+32
3
0
Длина параметров базовой линии
+36
2
Длина параметров в байтах + 4
Номер примитива базовой линии
+38
2
Любой линейный примитив
Параметры по типу примитива
+40
?

Длина параметров векторного объекта начинающего линию
+0
2
Длина параметров в байтах + 4
Номер примитива
+2
2
0 или 149
Параметры по типу примитива
+4
?

Длина параметров векторного объекта заканчивающего линию
+0
2
Длина параметров в байтах + 4
Номер примитива
+2
2
0 или 149
Параметры по типу примитива
+4
?

Длина параметров векторного объекта отображающегося на каждой точке метрики слева
+0
2
Длина параметров в байтах + 4
Номер примитива
+2
2
0 или 149
Параметры по типу примитива
+4
?

Длина параметров векторного объекта отображающегося на каждой точке метрики справа
+0
2
Длина параметров в байтах + 4
Номер примитива
+2
2

Параметры по типу примитива
+4
?
0 или 149
Длина параметров первого векторного объекта, заполняющего отрезки метрики
+0
2
Длина параметров в байтах + 4
Номер примитива
+2
2
0 или 149
Параметры по типу примитива
+4
?

Длина параметров второго векторного объекта, заполняющего отрезки метрики
+0
2
Длина параметров в байтах + 4
Номер примитива
+2
2
0 или 149
Параметры по типу примитива
+4
?

Итого:   N1

Примечания:
1. Для линии, у которой векторные знаки расположены в начале и конце  каждого отрезка, заполните параметры примитивов для векторного отрезка. Такие линии используются, например, для изображения линий   электропередач.
Если начало или конец линии объекта должны быть выделены (мост, туннель), заполните параметры примитивов для начало или конца линии.
Для объектов расположенных равномерно вдоль линии введите параметры заполняющих объектов. Можно ввести как один, так и два чередующихся между собой объекта, находящихся  на заданном расстоянии друг от друга (используется для изображения нефтепроводов, линий  связи, насыпей).
Все остальные примитивы должны иметь номер примитива 127 – пустой примитив,
Длина параметров 4 байта. Параметров для пустого примитива нет.

13. Текст, код типа примитива  142.

Назначение поля
Смещение
Длина
Комментарий

Цвет текста
+0
4

Цвет фона
+4
4
0x0FFFFFFFF – прозрачный
Цвет тени
+8
4
0x0FFFFFFFF –    прозрачный
Высота
+12
4
Если 0 – высота будет рассчитываться по метрике выводимого текста
Толщина контура шрифта
+16
4
Примечание 1.
Выравнивание
+20
2
0
Резерв
+22
2
0
Ширина символа
+24
1
Примечание 2.
Признак горизонтального расположения
+25
1
1- шрифт располагается горизонтально
Признак наклона символа
+26
1
1- курсив
Признак подчеркивания
+27
1
1- подчеркивание
Признак перечеркивания
+28
1
1- перечеркивание
Тип шрифта
+29
1
Номер шрифта в таблице шрифтов классификатора
Кодовая страница
+30
1
Примечание 3
Флаг
+31
1
1 - признак масштабирования по метрике

Итого:  32 байта

Примечания:
1. Возможные значения для толщины контура шрифта:
THIN                     - 100;
EXTRALIGHT      - 200;
LIGHT                   - 300;
NORMAL              - 400;
MEDIUM               - 500;
SEMIBOLD            - 600;
BOLD                     - 700;
EXTRABOLD        - 800;
HEAVY                  - 900;
2. Возможные значения для ширины символа
Нормальный – 0;
Суженый       – 1;
Широкий       – 2;
3. Для учета кодовой страницы используются Windows константы. Для России (ANSY/WINDOWS) – RUSSIAN_CHARSET, (OEM/866/DOS)-OEM_CHARSET.
Возможны другие Windows константы.

14. Шрифт пользователя, код типа примитива  152.
Используется для отображения текста произвольным шрифтом (не входящим в таблицу шрифтов классификатора).

Назначение поля
Смещение
Длина
Комментарий

Параметры шрифта
+ 0
32

Условное название шрифта
+32
32

Итого:  64 байта

15. Шаблон, код типа примитива  150.

Назначение поля
Смещение
Длина
Комментарий

Длина параметров
+0
4
В байтах (N1)
Длина заголовка шаблона
+4
4
60
Тип клетки
+8
12*4
Примечание 1.
Номер клетки привязки
+56
4
От 0 до 11
Тип  расположения
+60
4
0 – горизонтально   1 -  по метрике
Количество примитивов
+64
4
От 1до 3.
Длина 1 примитива
+68
2
32 +4
Номер примитива
+70
2
142
Параметры по типу примитива
+72
32
Параметры текста
Длина  второго примитива
+104
2
Длина параметров примитива + 4
Номер примитива
+106
2
128 – если в шаблоне есть линия
иначе номер примитива знака
Параметры по типу примитива
+108
?

Длина  третьего примитива
+0
2
Длина параметров примитива + 4
Номер примитива
+2
2
Номер примитива знака 143,149 или 151
Параметры по типу примитива
+4
?

Итого:   N1

Примечания:
1. Элементы шаблона: текст, линия и знак – располагаются в таблице из 12 клеток   (4 – по горизонтали и 3 – по вертикали).   Возможные значения  для типа клетки:  0  - пустая клетка, -1 – в клетке размещается линия, -2 – в клетке знак. Если значение больше 0, в клетке размещается текст, который является подписью к семантике с таким классификационным кодом. При отображении элементы шаблона выравниваются с учетом размера  конкретного текста шаблона. Приведем пример таблицы, для шаблона  смешанной растительности:

262
0
1
0

0
-2
-1
61
262
0
60
0



Двойной рамкой обведена клетка привязки шаблона. Ее номер 5(начинаем с 0 по строкам).
2. Второго и третьего примитива в шаблоне может не быть. Тогда шаблон состоит только из текста. Параметры текста должны быть заполнены в шаблоне всегда. На втором месте в параметрах может стоять линия или при отсутствии линии знак.
16. Знак True-Type шрифта, код типа примитива  151.

Назначение поля
Смещение
Длина
Комментарий

Параметры шрифта
+0
32

Условное название шрифта
+32
32

Номер знака в шрифте
+64
4

Габариты знака относительно точки привязки
+68
4*4
В микрометрах. Примечание 1
Точка привязки знака по вертикали
+84
4
В микрометрах
Точка привязки знака по горизонтали
+88
4
В микрометрах
Итого:  92

Примечание:
Габариты знака, относительно точки привязки  последовательно – максимальное отклонение от точки привязки вверх, влево, вниз, вправо – все отклонения в микрометрах.

17. Набор примитивов, код типа примитива  147.
Для формирования более сложных изображений объектов, используются наборы примитивов. Все примитивы набора рисуются по одной метрике. Первый примитив рисуется первым.

Назначение поля
Смещение
Длина
Комментарий

Идентификатор записи
+0
4
0x7FFF7FFFE
Полная длина параметров
+4
4
В байтах(N1)
Количество примитивов
+8
4

Длина 1 примитива
+12
2
Длина параметров +4
Номер примитива
+14
2

Параметры по типу примитива
+16
?

Далее три  строки для каждого примитива
Итого:   N1


18. Наборная штриховая линия, код типа примитива  158.
Для формирования более сложных линейных объектов, используется наборная  штриховая линия. Она состоит из отдельных секций заданной длины. Секции заполняют метрику последовательно. Набор повторяется до исчерпания длины метрики.

Назначение поля
Смещение
Длина
Комментарий

Полная длина параметров
+0
4
В байтах(N1)
Количество секций
+4
4
Число отдельных секций: iтрихов, пробелов, векторных знаков, знаков TRUE_TYPE
Номер завершающей секции
+8
4
Порядковый (с 1) номер секции, завершаюшей изображение.
Максимальная толщина секций
+12
4
В микрометрах
Резерв
+16
4
Резерв
Длина первой секции (заголовок + параметры)
+20
4
Длина параметров +16
Номер примитива
+24
4
линия, пустой примитив, векторный знак, знак TRUE_TYPE
Длина отрезка, занимаемого секцией
+28
4
В микрометрах
Параметры по типу примитива
+32
?

Далее четыре  строки для каждой секции
Итого:   N1

19. Точечный знак _ графическое изображение, код типа примитива  165.

Назначение поля
Смещение
Длина
Комментарий

Длина
+0
4
В байтах
Идентификатор изображения
+4
4
0
Имя файла изображения
+8
256
Полное имя файла
Тип файла изображения
+264
4
1-BMP
Габариты знака (высота)
+268
4
В микрометрах
Габариты знака (ширина)
+272
4
В микрометрах
Привязка знака от начала габаритов (высота)
+276
4
В микрометрах
Привязка знака от начала габаритов (ширина)
+280
4
В микрометрах
Смещение тени
+284
4
В микрометрах
Параметры контура
+288
8
Параметры линии
Флаг наличия контура
+296
1
1- рисовать контур
Флаг наличия тени
+297
1
1- есть тень
Резерв
+298
14

Итого: 312 байт


20. Объект пользователя, код типа примитива  250. Используется для формирования объектов разнообразного вида. Пользователь может строить метрику объекта по существующующей и рисовать различные знаки, используя стандартнве примитивы. Для построения отображения таких объектов используются спещиально разработанные IML – библиотеки. Параметры же таких объектов описываются следующим образом.

Назначение поля
Смещение
Длина
Комментарий

Длина описания объекта
+0
4
В байтах
Код DLL(IML)
+4
4
0
Индекс DLL в списке библиотек
+8
4
0 – не использовать
Код функции в библиотеке
+12
4
Порядковый номер функции в библиотеке пользователя
Параметры фукнкции
+14
N1
Набор примитивов (147)
Итого: 14+N1 байт
